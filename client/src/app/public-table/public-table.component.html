<h3 class="text-center">Material Takeoff Database</h3>

<hr class="rounded">

<div class="alert alert-light" role="alert">
  Please use the provided form fields to filter through the database.
  You can scroll to the bottom of the page in order to download the <b>displayed</b>
  table.
</div>
<!-- Filters -->

<form [formGroup]="searchForm" class="search_form">

  <div class="container">

    <mat-form-field class="search_form_field" appearance="fill">
      <mat-label>Project Name</mat-label>
      <input type="text"
             aria-label="Project Name"
             matInput
             formControlName="projName"
             (keyup)="applyFilter()"
      >
    </mat-form-field>

    <mat-form-field class="search_form_field" appearance="fill">
      <mat-label>Platform Name</mat-label>
      <input type="text"
             aria-label="Platform Number"
             matInput
             formControlName="platName"
             (keyup)="applyFilter()"
      >
    </mat-form-field>

    <mat-form-field class="search_form_field" appearance="fill">
      <mat-label>Structure Type</mat-label>
      <input type="text"
             aria-label="Structural Type"
             matInput
             formControlName="structType"
             (keyup)="applyFilter()"
      >
    </mat-form-field>

    <mat-form-field class="search_form_field" appearance="fill">
      <mat-label>Structure Area</mat-label>
      <input type="text"
             aria-label="Platform Type"
             matInput
             formControlName="structArea"
             (keyup)="applyFilter()"
      >
    </mat-form-field>

    <mat-form-field class="search_form_field" appearance="fill">
      <mat-label>Platform Area</mat-label>
      <input type="text"
             aria-label="Platform Area"
             matInput
             formControlName="platArea"
             (keyup)="applyFilter()"
      >
    </mat-form-field>

  </div>

  <div class="container">

    <mat-form-field class="search_form_field" appearance="fill">
      <mat-label>Sub Platform Area</mat-label>
      <input type="text"
             aria-label="Sub Platform Area"
             matInput
             formControlName="subArea"
             (keyup)="applyFilter()"
      >
    </mat-form-field>

    <mat-form-field class="search_form_field" appearance="fill">
      <mat-label>Material Type</mat-label>
      <input type="text"
             aria-label="Material Type"
             matInput
             formControlName="matType"
             (keyup)="applyFilter()"
      >
    </mat-form-field>

    <mat-form-field class="search_form_field" appearance="fill">
      <mat-label>Material Variant</mat-label>
      <input type="text"
             aria-label="Material Variant"
             matInput
             formControlName="matVariant"
             (keyup)="applyFilter()"
      >
    </mat-form-field>

    <mat-form-field class="search_form_field" appearance="fill">
      <mat-label>Procurement Method</mat-label>
      <input type="text"
             aria-label="Procurement Method"
             matInput
             formControlName="procMethod"
             (keyup)="applyFilter()"
      >
    </mat-form-field>

    <mat-form-field class="search_form_field" appearance="fill">
      <mat-label>Material Group</mat-label>
      <input type="text"
             aria-label="Material Group"
             matInput
             formControlName="matGroup"
             (keyup)="applyFilter()"
      >
    </mat-form-field>

  </div>

</form>

<!-- Database Table -->

<div class="search_table mat-elevation-z8 table-wrapper">

  <table mat-table [dataSource]="entries" class="mat-elevation-z0" matSort id="entries-table">

    <!-- id Column -->
    <ng-container matColumnDef="id">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> ID</th>
      <td mat-cell *matCellDef="let entry"> {{entry.id}} </td>
    </ng-container>

    <!-- projName Column -->
    <ng-container matColumnDef="projName">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Project Name</th>
      <td mat-cell *matCellDef="let entry"> {{entry.projName}} </td>
    </ng-container>

    <!-- platName Column -->
    <ng-container matColumnDef="platName">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Platform Name</th>
      <td mat-cell *matCellDef="let entry"> {{entry.platName}} </td>
    </ng-container>

    <!-- structType Column -->
    <ng-container matColumnDef="structType">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Structure Type</th>
      <td mat-cell *matCellDef="let entry"> {{entry.structType}} </td>
    </ng-container>

    <!-- structArea Column -->
    <ng-container matColumnDef="structArea">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Structure Area</th>
      <td mat-cell *matCellDef="let entry"> {{entry.structArea}} </td>
    </ng-container>

    <!-- platArea Column -->
    <ng-container matColumnDef="platArea">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Platform Area</th>
      <td mat-cell *matCellDef="let entry"> {{entry.platArea}} </td>
    </ng-container>

    <!-- subArea Column -->
    <ng-container matColumnDef="subArea">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Platform Sub Area</th>
      <td mat-cell *matCellDef="let entry"> {{entry.subArea}} </td>
    </ng-container>

    <!-- matType Column -->
    <ng-container matColumnDef="matType">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Material Type</th>
      <td mat-cell *matCellDef="let entry"> {{entry.matType}} </td>
    </ng-container>

    <!-- matVariant Column -->
    <ng-container matColumnDef="matVariant">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Material Variant</th>
      <td mat-cell *matCellDef="let entry"> {{entry.matVariant}} </td>
    </ng-container>

    <!-- procMethod Column -->
    <ng-container matColumnDef="procMethod">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Procurement Method</th>
      <td mat-cell *matCellDef="let entry"> {{entry.procMethod}} </td>
    </ng-container>

    <!-- dwgNo Column -->
    <ng-container matColumnDef="dwgNo">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> DWG Number</th>
      <td mat-cell *matCellDef="let entry"> {{entry.dwgNo}} </td>
    </ng-container>

    <!-- dwgCode Column -->
    <ng-container matColumnDef="dwgCode">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> DWG Code</th>
      <td mat-cell *matCellDef="let entry"> {{entry.dwgCode}} </td>
    </ng-container>

    <!-- matGroup Column -->
    <ng-container matColumnDef="matGroup">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Material Group</th>
      <td mat-cell *matCellDef="let entry"> {{entry.matGroup}} </td>
    </ng-container>

    <!-- description Column -->
    <ng-container matColumnDef="description">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Description</th>
      <td mat-cell *matCellDef="let entry"> {{entry.description}} </td>
    </ng-container>

    <!-- diameter Column -->
    <ng-container matColumnDef="diameter">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Diameter</th>
      <td mat-cell *matCellDef="let entry"> {{entry.diameter}} </td>
    </ng-container>

    <!-- thickness Column -->
    <ng-container matColumnDef="thickness">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Thickness</th>
      <td mat-cell *matCellDef="let entry"> {{entry.thickness}} </td>
    </ng-container>

    <!-- nal Column -->
    <ng-container matColumnDef="nal">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> NAL</th>
      <td mat-cell *matCellDef="let entry"> {{entry.nal}} </td>
    </ng-container>

    <!-- unitWeight Column -->
    <ng-container matColumnDef="unitWeight">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Unit Weight</th>
      <td mat-cell *matCellDef="let entry"> {{entry.unitWeight}} </td>
    </ng-container>

    <!-- baseWeight Column -->
    <ng-container matColumnDef="baseWeight">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Base Weight (kg)</th>
      <td mat-cell *matCellDef="let entry"> {{entry.baseWeight}} </td>
    </ng-container>

    <!-- surfaceArea Column -->
    <ng-container matColumnDef="surfaceArea">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Surface Area (mÂ²)</th>
      <td mat-cell *matCellDef="let entry"> {{entry.surfaceArea}} </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;"
        (click)="onRowClicked(row)"></tr>

  </table>

  <mat-paginator [pageSizeOptions]="[10, 50, 100, 250, 1000]" showFirstLastButtons></mat-paginator>

</div>

<!-- Download button -->
<div class="d-flex py-2 justify-content-center">
  <button class="btn btn-success">
    <a style="cursor: pointer" (click)="exportexcel()">
      Download Table<!-- <mat-icon> get_app </mat-icon> -->
    </a>
  </button>
</div>


